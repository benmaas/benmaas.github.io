<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autolening Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-plugin-addimage/dist/jspdf.plugin.addimage.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .calculator {
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 8px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select, button {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }
        input[type="number"] {
            width: calc(100% - 16px);
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        #downloadPDF {
            background-color: #008CBA;
        }
        #downloadPDF:hover {
            background-color: #007B9A;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h2>Autolening Calculator</h2>
        <div class="input-group">
            <label for="carModel">Automodel:</label>
            <select id="carModel">
                <option value="10000">Model A - €10.000</option>
                <option value="20000">Model B - €20.000</option>
                <option value="30000">Model C - €30.000</option>
                <option value="40000">Model D - €40.000</option>
                <option value="50000">Model E - €50.000</option>
                <option value="60000">Model F - €60.000</option>
            </select>
        </div>
        <div class="input-group">
            <label for="deposit">Aanbetaling:</label>
            <input type="range" id="depositSlider" min="0" max="60000" step="100" value="0">
            <input type="number" id="depositInput" min="0" max="60000" step="100" value="0">
        </div>
        <div class="input-group">
            <label for="accessories">Accessoires waarde:</label>
            <input type="range" id="accessoriesSlider" min="0" max="10000" step="100" value="0">
            <input type="number" id="accessoriesInput" min="0" max="10000" step="100" value="0">
        </div>
        <div class="input-group">
            <label for="months">Looptijd:</label>
            <select id="months">
                <option value="12">12 maanden</option>
                <option value="24">24 maanden</option>
                <option value="36">36 maanden</option>
                <option value="48">48 maanden</option>
                <option value="60">60 maanden</option>
            </select>
        </div>
        <div id="result">Maandelijkse betaling: €0.00</div>
        <button id="downloadPDF">Download PDF</button>
    </div>

    <script>
        const { jsPDF } = window.jspdf;

        const carModel = document.getElementById('carModel');
        const depositSlider = document.getElementById('depositSlider');
        const depositInput = document.getElementById('depositInput');
        const accessoriesSlider = document.getElementById('accessoriesSlider');
        const accessoriesInput = document.getElementById('accessoriesInput');
        const months = document.getElementById('months');
        const result = document.getElementById('result');
        const downloadPDFButton = document.getElementById('downloadPDF');

        let calculatedAmount = 0;

        [carModel, depositSlider, depositInput, accessoriesSlider, accessoriesInput, months].forEach(el => {
            el.addEventListener('input', calculateLoan);
        });

        depositSlider.addEventListener('input', () => {
            depositInput.value = depositSlider.value;
        });
        depositInput.addEventListener('input', () => {
            depositSlider.value = depositInput.value;
        });

        accessoriesSlider.addEventListener('input', () => {
            accessoriesInput.value = accessoriesSlider.value;
        });
        accessoriesInput.addEventListener('input', () => {
            accessoriesSlider.value = accessoriesInput.value;
        });

        function updateDepositMax() {
            const maxDeposit = parseInt(carModel.value);
            depositSlider.max = maxDeposit;
            depositInput.max = maxDeposit;
            depositSlider.value = Math.min(depositSlider.value, maxDeposit);
            depositInput.value = depositSlider.value;
            calculateLoan();
        }

        function calculateLoan() {
            const carPrice = parseInt(carModel.value);
            const depositAmount = parseInt(depositSlider.value);
            const accessoriesAmount = parseInt(accessoriesSlider.value);
            const loanTerm = parseInt(months.value);

            const totalPrice = carPrice + accessoriesAmount - depositAmount;
            const interestRate = 0.05; // 5% jaarlijkse rente
            const monthlyInterest = interestRate / 12;
            const numberOfPayments = loanTerm;

            const monthlyPayment = (totalPrice * monthlyInterest * Math.pow(1 + monthlyInterest, numberOfPayments)) / (Math.pow(1 + monthlyInterest, numberOfPayments) - 1);

            calculatedAmount = monthlyPayment.toFixed(2);
            result.textContent = `Maandelijkse betaling: €${calculatedAmount}`;
        }

        function generatePDF() {
            const doc = new jsPDF();

            // Laad de achtergrondafbeelding
            doc.loadFile('sjabloon.png', undefined, function() {
                // Voeg de achtergrondafbeelding toe
                doc.addPage();
                doc.setPage(1);
                doc.addImage(this.buffer, 'PNG', 0, 0, 210, 297);

                // Voeg de berekende gegevens toe
                doc.setFontSize(18);
                doc.setTextColor(0, 0, 0); // Zwarte tekst
                doc.text('Autolening Berekening', 20, 40);

                doc.setFontSize(12);
                doc.text(`Automodel: ${carModel.options[carModel.selectedIndex].text}`, 20, 60);
                doc.text(`Aanbetaling: €${depositSlider.value}`, 20, 70);
                doc.text(`Accessoires waarde: €${accessoriesSlider.value}`, 20, 80);
                doc.text(`Looptijd: ${months.value} maanden`, 20, 90);
                doc.text(`Maandelijkse betaling: €${calculatedAmount}`, 20, 110);

                // Sla de PDF op
                doc.save('autolening-berekening.pdf');
            });
        }

        carModel.addEventListener('change', updateDepositMax);
        updateDepositMax();
        calculateLoan();

        downloadPDFButton.addEventListener('click', generatePDF);
    </script>
</body>
</html>